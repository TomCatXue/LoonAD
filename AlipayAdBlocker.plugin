#!name = æ”¯ä»˜å®å°ç¨‹åºå»å¹¿å‘Š (Switchable v2.0)
#!desc = å±è”½æ”¯ä»˜å®å¹¿å‘ŠAPIå’Œå°ç¨‹åºæµé‡ä½æ’ä»¶ï¼Œæ”¯æŒå¤šæ¨¡å—ç‹¬ç«‹å¼€å…³æ§åˆ¶
#!openUrl = https://apps.apple.com/app/id333206289
#!author = TomCatXue & å¯è‰ğŸ…¥[https://gitlab.com/lodepuly/vpn_tool/-/blob/master/README.md]
#!raw-url = https://raw.githubusercontent.com/TomCatXue/LoonAD/main/AlipayMiniProgramAdBlock.plugin
#!tag = å»å¹¿å‘Š,æ”¯ä»˜å®
#!system = iOS
#!system_version = 14.0
#!loon_version = 3.2.1(749)
#!homepage = https://github.com/TomCatXue/LoonAD
#!icon = https://gw.alipayobjects.com/zos/rmsportal/UTjFYEzMSYVwzxIGVhMu.png
#!date = 2024-09-27 22:18:09

# ==================================================
# å‚æ•°é…ç½®åŒºï¼ˆå¼€å…³æ§åˆ¶ï¼‰- æ¯ä¸ªå¹¿å‘Šæ¨¡å—ç‹¬ç«‹å¼€å…³
# ==================================================
[Argument]

# ===== ä¸»å¼€å…³ =====
ä¸»å¼€å…³ = true

# ===== å¹¿å‘ŠAPIæ¨¡å—å¼€å…³ =====
å¹¿å‘Šä»£ç†å•†æŠ•æ”¾æ•°æ®æŸ¥è¯¢ = true
å¹¿å‘ŠæŠ•æ”¾æ•°æ®é€šç”¨æŸ¥è¯¢ = true
å¹¿å‘Šå•†å®¶æŒ‡æ ‡æŸ¥è¯¢ = true
è‡ªå»ºæ¨å¹¿é¡µç›¸å…³ = true
ä»»åŠ¡å¹¿å‘ŠçŠ¶æ€æŸ¥è¯¢ = true

# ===== å°ç¨‹åºæµé‡ä½æ¨¡å—å¼€å…³ =====
å°ç¨‹åºæ’ä»¶å±è”½ = true
å°ç¨‹åºæµé‡ä½å±è”½ = true
AMSæ’ä»¶ç³»ç»Ÿå±è”½ = true

# ===== é€šç”¨å¹¿å‘Šæ¨¡å—å¼€å…³ =====
å¼€å±å¹¿å‘Šå±è”½ = true
ä¿¡æ¯æµå¹¿å‘Šå±è”½ = true
è¥é”€æ´»åŠ¨å±è”½ = true
æ¿€åŠ±å¹¿å‘Šå±è”½ = false

# ===== è®¾ç½®é€‰é¡¹ =====
æ—¥å¿—è®°å½• = false
å“åº”æ¨¡å¼ = reject  # reject|empty|modify

# ==================================================
# è§„åˆ™åŒº
# ==================================================
[Rule]

# æ”¯ä»˜å®é€šç”¨åŸŸåç›´è¿
DOMAIN-SUFFIX,alipay.com,DIRECT
DOMAIN-SUFFIX,alipayobjects.com,DIRECT
DOMAIN-SUFFIX,alipaydn.com,DIRECT

# å¹¿å‘ŠåŸŸåå±è”½ï¼ˆç‹¬ç«‹å¼€å…³ï¼‰
DOMAIN,ad.alipay.com,REJECT,enabled=ä¸»å¼€å…³
DOMAIN,ads.alipay.com,REJECT,enabled=ä¸»å¼€å…³
DOMAIN,advert.alipay.com,REJECT,enabled=ä¸»å¼€å…³
DOMAIN,promotion.alipay.com,REJECT,enabled=ä¸»å¼€å…³

# å°ç¨‹åºç›¸å…³åŸŸåå±è”½
DOMAIN,e.alipay.com,REJECT,enabled=å°ç¨‹åºæµé‡ä½å±è”½
DOMAIN,mr.alipay.com,REJECT,enabled=å°ç¨‹åºæ’ä»¶å±è”½

# ==================================================
# é‡å†™åŒºï¼ˆæ¯ä¸ªæ¨¡å—ç‹¬ç«‹å¼€å…³ï¼‰
# ==================================================
[Rewrite]

# ----- æ¨¡å—1ï¼šå¹¿å‘Šä»£ç†å•†æŠ•æ”¾æ•°æ®æŸ¥è¯¢ -----
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.agentreportdata\.query reject-dict,enabled=å¹¿å‘Šä»£ç†å•†æŠ•æ”¾æ•°æ®æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—2ï¼šå¹¿å‘ŠæŠ•æ”¾æ•°æ®é€šç”¨æŸ¥è¯¢ -----
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.reportdata\.query reject-dict,enabled=å¹¿å‘ŠæŠ•æ”¾æ•°æ®é€šç”¨æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—3ï¼šå¹¿å‘Šå•†å®¶æŒ‡æ ‡æŸ¥è¯¢ -----
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.reportmetric\.query reject-dict,enabled=å¹¿å‘Šå•†å®¶æŒ‡æ ‡æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—4ï¼šè‡ªå»ºæ¨å¹¿é¡µç›¸å…³ -----
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.promotepage\.batchquery reject-dict,enabled=è‡ªå»ºæ¨å¹¿é¡µç›¸å…³
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.promotepage\.download reject-dict,enabled=è‡ªå»ºæ¨å¹¿é¡µç›¸å…³
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—5ï¼šä»»åŠ¡å¹¿å‘ŠçŠ¶æ€æŸ¥è¯¢ -----
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.xlight\.task\.query reject-dict,enabled=ä»»åŠ¡å¹¿å‘ŠçŠ¶æ€æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—6ï¼šé€šç”¨å¹¿å‘ŠAPIæ¨¡å¼ -----
^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\..* reject-dict,enabled=ä¸»å¼€å…³
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—7ï¼šè¥é”€ç›¸å…³API -----
^https:\/\/[^\/]+\/alipay\.marketing\..* reject-dict,enabled=è¥é”€æ´»åŠ¨å±è”½
^https:\/\/[^\/]+\/alipay\.commerce\.operation\..* reject-dict,enabled=è¥é”€æ´»åŠ¨å±è”½
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- æ¨¡å—8ï¼šå°ç¨‹åºæ’ä»¶ç³»ç»Ÿ -----
^https:\/\/[^\/]+\/miniapp\/plugin\/.* reject-dict,enabled=å°ç¨‹åºæ’ä»¶å±è”½
hostname = *.alipay.com, *.alipayobjects.com

# ----- æ¨¡å—9ï¼šå°ç¨‹åºæµé‡ä½ -----
^https:\/\/[^\/]+\/miniapp\/traffic\/.* reject-dict,enabled=å°ç¨‹åºæµé‡ä½å±è”½
hostname = *.alipay.com, *.alipayobjects.com

# ----- æ¨¡å—10ï¼šAMSæ’ä»¶ç³»ç»Ÿ -----
^https:\/\/[^\/]+\/ams\/plugin\/.* reject-dict,enabled=AMSæ’ä»¶ç³»ç»Ÿå±è”½
hostname = *.alipay.com, *.alipayobjects.com

# ----- æ¨¡å—11ï¼šå¼€å±å¹¿å‘Šç›¸å…³ -----
^https:\/\/amdc\.alipay\.com\/.* reject-dict,enabled=å¼€å±å¹¿å‘Šå±è”½
hostname = amdc.alipay.com

^https:\/\/adash\.m\.taobao\.com\/.* reject-dict,enabled=å¼€å±å¹¿å‘Šå±è”½
hostname = adash.m.taobao.com

^https:\/\/adashx\.m\.taobao\.com\/.* reject-dict,enabled=å¼€å±å¹¿å‘Šå±è”½
hostname = adashx.m.taobao.com

^https:\/\/render\.alipay\.com\/.* reject-dict,enabled=å¼€å±å¹¿å‘Šå±è”½
hostname = render.alipay.com

# ----- æ¨¡å—12ï¼šä¿¡æ¯æµå¹¿å‘Š -----
^https:\/\/mss\.alipay\.com\/.* reject-dict,enabled=ä¿¡æ¯æµå¹¿å‘Šå±è”½
hostname = mss.alipay.com

# ----- æ¨¡å—13ï¼šæ¿€åŠ±å¹¿å‘Šç´ æ -----
^https:\/\/video\.alicdn\.com\/.* reject-dict,enabled=æ¿€åŠ±å¹¿å‘Šå±è”½
hostname = video.alicdn.com

^https:\/\/gw\.alicdn\.com\/.* reject-dict,enabled=æ¿€åŠ±å¹¿å‘Šå±è”½
hostname = gw.alicdn.com

# ----- æ¨¡å—14ï¼šå¹¿å‘Šè°ƒåº¦æœåŠ¡ -----
^https:\/\/(.+)\.tanx\.com\/.* reject-dict,enabled=ä¸»å¼€å…³
hostname = *.tanx.com

^https:\/\/(.+)\.alimama\.com\/.* reject-dict,enabled=ä¸»å¼€å…³
hostname = *.alimama.com

# ----- æ¨¡å—15ï¼šå¹¿å‘Šç»Ÿè®¡ -----
^https:\/\/(.+)\.mmstat\.com\/.* reject-dict,enabled=ä¸»å¼€å…³
hostname = *.mmstat.com

# ----- æ¨¡å—16ï¼šèš‚èšè®¤è¯ç›¸å…³ -----
^https:\/\/antcert\.antgroup\.com\/.* reject-dict,enabled=è¥é”€æ´»åŠ¨å±è”½
hostname = antcert.antgroup.com

^https:\/\/certify\.alipay\.com\/.* reject-dict,enabled=è¥é”€æ´»åŠ¨å±è”½
hostname = certify.alipay.com

# ==================================================
# è„šæœ¬åŒºï¼ˆé«˜çº§å¤„ç†ï¼‰
# ==================================================
[Script]

# ----- æ ¸å¿ƒå¹¿å‘ŠAPIå¤„ç†è„šæœ¬ -----
http-response ^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.agentreportdata\.query requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayAdBlock.js, tag=å¹¿å‘Šä»£ç†å•†æŠ•æ”¾æ•°æ®å±è”½, argument=module=agentreport&logging=æ—¥å¿—è®°å½•&mode=å“åº”æ¨¡å¼, timeout=30, enabled=å¹¿å‘Šä»£ç†å•†æŠ•æ”¾æ•°æ®æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

http-response ^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.reportdata\.query requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayAdBlock.js, tag=å¹¿å‘ŠæŠ•æ”¾æ•°æ®é€šç”¨å±è”½, argument=module=reportdata&logging=æ—¥å¿—è®°å½•&mode=å“åº”æ¨¡å¼, timeout=30, enabled=å¹¿å‘ŠæŠ•æ”¾æ•°æ®é€šç”¨æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

http-response ^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.reportmetric\.query requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayAdBlock.js, tag=å¹¿å‘Šå•†å®¶æŒ‡æ ‡å±è”½, argument=module=reportmetric&logging=æ—¥å¿—è®°å½•&mode=å“åº”æ¨¡å¼, timeout=30, enabled=å¹¿å‘Šå•†å®¶æŒ‡æ ‡æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

http-response ^https:\/\/[^\/]+\/alipay\.data\.dataservice\.ad\.promotepage requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayAdBlock.js, tag=è‡ªå»ºæ¨å¹¿é¡µå±è”½, argument=module=promotepage&logging=æ—¥å¿—è®°å½•&mode=å“åº”æ¨¡å¼, timeout=30, enabled=è‡ªå»ºæ¨å¹¿é¡µç›¸å…³
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

http-response ^https:\/\/[^\/]+\/alipay\.data\.dataservice\.xlight\.task\.query requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayAdBlock.js, tag=ä»»åŠ¡å¹¿å‘ŠçŠ¶æ€å±è”½, argument=module=taskquery&logging=æ—¥å¿—è®°å½•&mode=å“åº”æ¨¡å¼, timeout=30, enabled=ä»»åŠ¡å¹¿å‘ŠçŠ¶æ€æŸ¥è¯¢
hostname = openapi.alipay.com, open.alipay.com, mapi.alipay.com

# ----- å°ç¨‹åºæµé‡ä½å¤„ç†è„šæœ¬ -----
http-response ^https:\/\/[^\/]+\/miniapp\/plugin\/.* requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayMiniPlugin.js, tag=å°ç¨‹åºæ’ä»¶å±è”½, argument=type=plugin&logging=æ—¥å¿—è®°å½•, timeout=30, enabled=å°ç¨‹åºæ’ä»¶å±è”½
hostname = *.alipay.com, *.alipayobjects.com

http-response ^https:\/\/[^\/]+\/miniapp\/traffic\/.* requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayMiniPlugin.js, tag=å°ç¨‹åºæµé‡ä½å±è”½, argument=type=traffic&logging=æ—¥å¿—è®°å½•, timeout=30, enabled=å°ç¨‹åºæµé‡ä½å±è”½
hostname = *.alipay.com, *.alipayobjects.com

http-response ^https:\/\/[^\/]+\/ams\/plugin\/.* requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayMiniPlugin.js, tag=AMSæ’ä»¶å±è”½, argument=type=ams&logging=æ—¥å¿—è®°å½•, timeout=30, enabled=AMSæ’ä»¶ç³»ç»Ÿå±è”½
hostname = *.alipay.com, *.alipayobjects.com

# ----- å¼€å±å¹¿å‘Šå¤„ç†è„šæœ¬ -----
http-response ^https:\/\/amdc\.alipay\.com\/.* requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipaySplash.js, tag=å¼€å±å¹¿å‘Šå±è”½, argument=type=splash&logging=æ—¥å¿—è®°å½•, timeout=30, enabled=å¼€å±å¹¿å‘Šå±è”½
hostname = amdc.alipay.com

http-response ^https:\/\/adash\.(m|wxs)\.taobao\.com\/.* requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipaySplash.js, tag=é˜¿é‡Œå¦ˆå¦ˆå¹¿å‘Šå±è”½, argument=type=alimama&logging=æ—¥å¿—è®°å½•, timeout=30, enabled=å¼€å±å¹¿å‘Šå±è”½
hostname = adash.m.taobao.com, adashx.m.taobao.com

# ----- ä¿¡æ¯æµå¹¿å‘Šå¤„ç†è„šæœ¬ -----
http-response ^https:\/\/mss\.alipay\.com\/.* requires-body=true, script-path=https://raw.githubusercontent.com/TomCatXue/LoonAD/main/Scripts/AlipayFeedAd.js, tag=ä¿¡æ¯æµå¹¿å‘Šå±è”½, argument=type=feed&logging=æ—¥å¿—è®°å½•, timeout=30, enabled=ä¿¡æ¯æµå¹¿å‘Šå±è”½
hostname = mss.alipay.com

# ==================================================
# MITMé…ç½®ï¼ˆå®Œæ•´ä¸»æœºååˆ—è¡¨ï¼‰
# ==================================================
[MitM]
hostname = 
    # æ”¯ä»˜å®æ ¸å¿ƒåŸŸå
    openapi.alipay.com,
    open.alipay.com,
    mapi.alipay.com,
    *.alipay.com,
    *.alipayobjects.com,
    *.alipaydn.com,
    
    # å¹¿å‘Šç›¸å…³åŸŸå
    ad.alipay.com,
    ads.alipay.com,
    advert.alipay.com,
    promotion.alipay.com,
    amdc.alipay.com,
    mss.alipay.com,
    render.alipay.com,
    
    # å°ç¨‹åºç›¸å…³
    e.alipay.com,
    mr.alipay.com,
    
    # é˜¿é‡Œç³»å¹¿å‘ŠåŸŸå
    *.taobao.com,
    video.alicdn.com,
    gw.alicdn.com,
    img.alicdn.com,
    
    # å¹¿å‘ŠæœåŠ¡å•†
    *.tanx.com,
    *.alimama.com,
    *.mmstat.com,
    
    # èš‚èšé›†å›¢
    *.antgroup.com,
    certify.alipay.com,
    antcert.antgroup.com,
    
    # å…¶ä»–å¯èƒ½åŸŸå
    *.tbcdn.cn,
    *.tanxlog.istreamsche.com,
    *.afp.alicdn.com

# æ³¨ï¼šéœ€è¦å¼€å¯Loonçš„MITMåŠŸèƒ½å¹¶å®‰è£…å¯¹åº”è¯ä¹¦
